!function(){var e=function(){function e(e,t,i){this.data=e,this.config=t,this.indeterminate=!1,this.parent=i||null,this.level=this.parent?this.parent.level+1:1,this.uid=e.id,this.checked=!1,this.initState(),this.initChildren()}return e.prototype.initState=function(){var e=this.config,t=e.value,i=e.label;this.value=this.data[t],this.label=this.data[i],this.pathNodes=this.calculatePathNodes(),this.path=this.pathNodes.map((function(e){return e.value})),this.pathLabels=this.pathNodes.map((function(e){return e.label}))},e.prototype.initChildren=function(){var t=this,i=this.config,n=i.children,a=this.data[n];this.hasChildren=Array.isArray(a),this.children=(a||[]).map((function(n){return new e(n,i,t)}))},e.prototype.calculatePathNodes=function(){for(var e=[this],t=this.parent;t;)e.unshift(t),t=t.parent;return e},e.prototype.getPath=function(){return this.path},e.prototype.getValue=function(){return this.value},e.prototype.onParentCheck=function(e){var t=this.children.length?this.children:this;this.checked=e,this.indeterminate=!1,this.doAllCheck(t,e)},e.prototype.doAllCheck=function(e,t){var i=this;Array.isArray(e)&&e.length&&e.forEach((function(e){e.checked=t,e.indeterminate=!1,i.doAllCheck(e.children,t)}))},e.prototype.onChildCheck=function(e){this.checked=e;var t=this.parent.children.every((function(e){return e.checked}));this.setCheckState(this.parent,t)},e.prototype.setCheckState=function(e,t){e.checked=t;var i=e.children.length,n=e.children.reduce((function(e,t){return e+(t.checked?1:t.indeterminate?.5:0)}),0);e.indeterminate=n!==i&&n>0,e.parent&&this.setCheckState(e.parent,t)},e}(),t=function(){var t={disabled:"disabled",emitPath:!0,value:"id",label:"label",children:"children"};function i(e,i){this.config=Object.assign(i,t)||null,this.multiple=i.multiple,this.separator=i.separator,this.data=e,this.clearable=i.clearable,this.panelShowState=!1,this.storageChecked={},this.checkedText=[],this.checkedID=[],this.ele=i.elementID,this.panelWrap=this.initPanel(),this.checkedWrap=this.initCheckedWrap(),this.initNodes(e),this.initEvents()}return i.prototype.initEvents=function(e){this.clearable&&(this.ele.addEventListener("mouseover",this.bindCascaderHover.bind(this)),this.ele.addEventListener("mouseout",this.bindCascaderOut.bind(this)))},i.prototype.bindBodyClick=function(e){"BODY"===e.target.tagName&&(this.panelShowState=!1,this.ele.className="app-cascader dropdown")},i.prototype.bindCascaderClick=function(e){e.stopPropagation(),e.target.id===this.ele.id&&(this.panelShowState=!this.panelShowState,this.ele.className=this.panelShowState?"app-cascader dropdown is-show":"app-cascader dropdown")},i.prototype.bindCascaderHover=function(e){e.stopPropagation(),e.target.id!==this.ele.id&&"eo-clear-btn"!==e.target.className||"{}"!==JSON.stringify(this.storageChecked)&&(this.ele.className=this.panelShowState?"app-cascader dropdown is-show is-clear":"app-cascader dropdown is-clear")},i.prototype.bindCascaderOut=function(e){e.stopPropagation(),e.target.id===this.ele.id&&(this.ele.className=this.panelShowState?"app-cascader dropdown is-show":"app-cascader dropdown")},i.prototype.initPanel=function(){var e=document.createElement("div");return e.className="dropdown-menu",e},i.prototype.initCheckedWrap=function(){var e=document.createElement("div");return e.className="eo-checked-wrap form-select dropdown-toggle d-flex",e.setAttribute("data-bs-toggle","dropdown"),e},i.prototype.initClearDom=function(){var e=document.createElement("i");e.className="eo-clear-btn",e.innerHTML="x";var t=this;return e.addEventListener("click",(function(e){e.stopPropagation(),t.storageChecked={},t.config.checkedValue=null,t.checkedText=[],t.checkedID=[],t.initNodes(t.data),t.initCheckedLi(),t.panelWrap.style.top=t.ele.offsetHeight+2+"px"})),e},i.prototype.initNodes=function(t){var i=this;this.nodes=t.map((function(t){return new e(t,i.config)})),this.menus=[this.nodes],this.config.checkedValue?this.findChecked(this.config.checkedValue):this.createNodes(this.menus),this.clearable&&this.ele.appendChild(this.initClearDom())},i.prototype.renderNodes=function(e){var t=this.menus.slice(0,e.level);e.children.length&&t.push(e.children),this.menus=t;var i=this.panelWrap,n=i.children;for(let t=e.level;t<i.children.length;t++)i.removeChild(n[t]),t-=1;return t},i.prototype.createNodes=function(e){var t=this.panelWrap;t.innerHTML="";var i=this;for(let o=0;o<e.length;o++){var n=document.createElement("div");n.className="eo-cascader-menu";var a=document.createElement("ul"),h=e[o];for(let e=0;e<h.length;e++){var r=document.createElement("li");if(h[e].children.length&&(r.className="has-child"),i.multiple){var c=document.createElement("label"),s=document.createElement("input");s.type="checkbox",s.checked=h[e].checked,s.setAttribute("uid",h[e].uid),s.className=h[e].indeterminate?"is-indeterminate":"",s.addEventListener("click",i.bindClickEvent.bind(s,i,i.handleCheckCb)),c.appendChild(s),r.appendChild(c)}var d=document.createElement("span");d.innerHTML=h[e].label,d.setAttribute("uid",h[e].uid),r.addEventListener("click",i.bindClickEvent.bind(d,i,i.handleDanxuanCb)),r.appendChild(d),a.appendChild(r)}n.appendChild(a),t.appendChild(n),t.style.top=i.ele.offsetHeight+2+"px"}this.ele.appendChild(t)},i.prototype.bindClickEvent=function(e,t){var i=this.getAttribute("uid"),n=e.menus.flat(1/0).filter((function(e){return e.uid==i}));"function"==typeof t&&t.call(this,n,e,this.checked),e.createNodes(e.renderNodes(n[0]))},i.prototype.handleDanxuanCb=function(e,t){t.multiple||(e[0].children.length||(t.storageChecked={},t.storageChecked[e[0].uid]=e[0].pathLabels,t.checkedWrap.innerHTML="",t.initCheckedLi()))},i.prototype.handleCheckCb=function(e,t,i){1!==e[0].level&&e[0].onChildCheck(i),e[0].onParentCheck(i),e[0].children.length?t.showReviewCheckedOb(e[0]):t.handleReviewCheckedOb(e[0]),t.checkedWrap.innerHTML="",t.initCheckedLi()},i.prototype.initCheckedLi=function(){var e=document.createElement("ul"),t=this;if("{}"===JSON.stringify(this.storageChecked))return this.checkedWrap.innerHTML="";for(const h in this.storageChecked)if(this.storageChecked.hasOwnProperty(h)){var i=document.createElement("li"),n=document.createElement("p"),a=document.createElement("i");i.setAttribute("uid",h),n.innerHTML=this.storageChecked[h].join(t.separator),a.innerHTML="x",a.addEventListener("click",(function(){var e=this.parentElement.getAttribute("uid");delete t.storageChecked[e];var i=function(n){for(let a=0;a<n.length;a++)n[a].children.length?i(n[a].children):n[a].uid==e&&(t.handleCheckCb([n[a]],t,!1),t.createNodes(t.menus))};i(t.nodes)})),i.appendChild(n),i.appendChild(a),e.appendChild(i),t.checkedWrap.appendChild(e)}this.ele.appendChild(this.checkedWrap)},i.prototype.findChecked=function(e){var t=this,i=[],n=this.nodes,a=function(n){for(let h=0;h<n.length;h++)n[h].children.length?a(n[h].children):e.includes(n[h].uid)&&(n[h].checked=!0,t.handleCheckCb([n[h]],t,!0),i.push(n[h]))};a(n);var h=[],r=function(e){if(e.parent)return h.push(e.parent.children),r(e.parent)};r(i[0]),h.reverse().forEach((function(e){t.menus.push(e)})),t.createNodes(this.menus)},i.prototype.showReviewCheckedOb=function(e){if(e.children.length)for(let t=0;t<e.children.length;t++)this.showReviewCheckedOb(e.children[t]);else this.handleReviewCheckedOb(e)},i.prototype.handleReviewCheckedOb=function(e){e.checked?this.storageChecked[e.uid]=e.pathLabels:delete this.storageChecked[e.uid]},i.prototype.getCheckedByText=function(){this.checkedText=[];for(const e in this.storageChecked)this.storageChecked.hasOwnProperty(e)&&this.checkedText.push(this.storageChecked[e].join(this.separator));return this.checkedText},i.prototype.getCheckedByID=function(){this.checkedID=[];for(const e in this.storageChecked)this.storageChecked.hasOwnProperty(e)&&this.checkedID.push(e-0);return this.checkedID},i}();window.eo_cascader=t}(window);
